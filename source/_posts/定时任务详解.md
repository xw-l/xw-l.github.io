---
title:  Crontab 定时任务
date:  2023-04-01 10:36:00
tags: linux
categories: linux基础
cover: https://pan.alybaba.top/images/linux.jpg
---

cron任务分为系统级任务和用户级任务
	
	系统cron任务
		操作系统自带的cron 任务，系统维护作业，/etc/crontab 主配置文件， /etc/cron.d/ 子配置文件
	
	用户cron任务
		每个用户自己名下的 cron 任务
		红帽系统保存在 /var/spool/cron/USERNAME
			日志在/var/log/cron
			systemctl status crond
		Ubuntu 系统存放在/var/spool/cron/crontabs/USERNAME，利用 crontab 命令管理
			systemctl status cron/etc/cron.deny     该文件中所列用户不允许使用crontab命令
	/etc/cron.allow    该文件中所列用户允许使用crontab命令
	/var/spool/cron/   所有用户crontab文件存放的目录,以用户名命名
	注意：只有/etc/crontab和/etc/cron.d/*中的文件可以指定用户名字段
	
Crontab文件的含义：用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间段，第六段为要执行的任务（ps：用户名也算一个字段吗？）格式如下
	
	minute   hour   day   month   week    [ users ]    command 
	  分      时    日     月      周       [用户]       任务
	
	minute： 表示分钟，可以是从0到59之间的任何整数。
	hour：表示小时，可以是从0到23之间的任何整数。
	day：表示日期，可以是从1到31之间的任何整数。
	month：表示月份，可以是从1到12之间的任何整数。
	week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。
	command：要执行的命令，可以是系统命令，如果命令无法执行，请更换PATH或SHELL。也可以是自己编写的脚本文件,脚本需要带路径。
	
	在以上各个字段中，还可以使用以下特殊字符：
	
	星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。
	逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”
	中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”
	正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。
	
	
	* * * * * command                                   代表每一分钟执行一次command  注意crontab最小单位是分钟
	
	3,15 * * * * command                                代表每小时的第三分钟和第十五分钟执行一次command
	
	3,15 8-11 * * * command                             代表每天上午{8..11}点每第三分钟和第十五分钟执行一次command
	
	3,15 8-11 */2 * * command                           代表每隔两天的上午{8..11}点的第三分钟和第十五分钟执行一次command
	
	3,15 8-11 * * 1 command                             代表每周一上午{8..11}点的第三分钟和第十五分钟执行一次command
	 
	30 21 * * * /etc/init.d/smb restart                 代表每天晚上九点半执行smb restart
	
	45 4 1,10,22 * * /etc/init.d/smb restart            代表每月一号，十号，二十二号的凌晨四点四十五分执行smb restart
	
	10 1 * * 6,0 /etc/init.d/smb restart                代表每周六，日的凌晨一点一十分执行smb restart
	
	0,30 18-23 * * * /etc/init.d/smb restart            代表每天晚上{18..23}之间每隔30分钟执行smb restart
	     
	0 23 * * 6 /etc/init.d/smb restart                  代表周六晚上十一点整点执行smb restart
	
	* */1 * * * /etc/init.d/smb restart                 代表每隔一小时执行一次smb restrat
	
	* 23-7/1 * * * /etc/init.d/smb restart              代表晚上十一点至早上七点每一小时执行一次smb restart
	
	0 11 4 * mon-wed /etc/init.d/smb restart 	    代表每月的四号和mon-wed【周一至周三】执行smb restart
	
	0 4 1 jan * /etc/init.d/smb restart                 代表Jan月一号凌晨四点执行smb restart
	
	01 * * * * root run-parts /etc/cron.hourly  	    代表每小时执行/etc/cron.hourly 里面的脚本
